slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
2025-05-19 20:10:35,550 - root - INFO - Experiment args: Namespace(save_speed_key='baseline', speed_results_path='/users/goymak/scratch/fast_attention_v3/speed_results.json', disable_pytorch_flash=False, save_path='/users/goymak/scratch/fast_attention_v3/baseline_model/model.pt', reference_model_path=None, use_flash_attn=False, dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=4096, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=1000, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=True)
2025-05-19 20:10:35,550 - root - INFO - Setting up DataLoaders...
2025-05-19 20:10:42,952 - root - INFO - Setting up Model...
2025-05-19 20:11:19,429 - root - WARNING - ⚠️ Skipping torch.compile because FlashAttention3 is incompatible with TorchDynamo.
2025-05-19 20:11:20,549 - root - INFO - Running with standard attention
2025-05-19 20:11:20,549 - root - INFO - Starting training!
/usr/local/lib/python3.12/dist-packages/torch/autograd/graph.py:825: UserWarning: cuDNN SDPA backward got grad_output.strides() != output.strides(), attempting to materialize a grad_output with matching strides... (Triggered internally at /opt/pytorch/pytorch/aten/src/ATen/native/cudnn/MHA.cpp:674.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
2025-05-19 20:11:24,411 - root - INFO - Step: 5 | Loss: 11.92 | Tokens/sec: 5362.96 | Training tokens/sec (%): 13.01 | MFU (%): 27.95 | TFLOPs: 276.41
2025-05-19 20:11:27,059 - root - INFO - Step: 10 | Loss: 11.81 | Tokens/sec: 7864.63 | Training tokens/sec (%): 25.72 | MFU (%): 40.99 | TFLOPs: 405.35
2025-05-19 20:11:29,732 - root - INFO - Step: 15 | Loss: 11.33 | Tokens/sec: 7786.47 | Training tokens/sec (%): 35.21 | MFU (%): 40.58 | TFLOPs: 401.32
2025-05-19 20:11:32,410 - root - INFO - Step: 20 | Loss: 10.92 | Tokens/sec: 7776.20 | Training tokens/sec (%): 34.78 | MFU (%): 40.53 | TFLOPs: 400.79
2025-05-19 20:11:35,037 - root - INFO - Step: 25 | Loss: 10.60 | Tokens/sec: 7925.35 | Training tokens/sec (%): 18.28 | MFU (%): 41.30 | TFLOPs: 408.48
2025-05-19 20:11:37,694 - root - INFO - Step: 30 | Loss: 9.80 | Tokens/sec: 7836.03 | Training tokens/sec (%): 26.99 | MFU (%): 40.84 | TFLOPs: 403.88
2025-05-19 20:11:40,300 - root - INFO - Step: 35 | Loss: 9.94 | Tokens/sec: 7994.19 | Training tokens/sec (%): 13.78 | MFU (%): 41.66 | TFLOPs: 412.03
2025-05-19 20:11:42,888 - root - INFO - Step: 40 | Loss: 10.13 | Tokens/sec: 8048.20 | Training tokens/sec (%): 9.95 | MFU (%): 41.94 | TFLOPs: 414.81
2025-05-19 20:11:45,502 - root - INFO - Step: 45 | Loss: 9.67 | Tokens/sec: 7967.99 | Training tokens/sec (%): 15.59 | MFU (%): 41.52 | TFLOPs: 410.68
2025-05-19 20:11:48,100 - root - INFO - Step: 50 | Loss: 9.66 | Tokens/sec: 8017.98 | Training tokens/sec (%): 10.93 | MFU (%): 41.79 | TFLOPs: 413.26
2025-05-19 20:11:50,767 - root - INFO - Step: 55 | Loss: 10.05 | Tokens/sec: 7803.88 | Training tokens/sec (%): 28.32 | MFU (%): 40.67 | TFLOPs: 402.22
2025-05-19 20:11:53,419 - root - INFO - Step: 60 | Loss: 9.65 | Tokens/sec: 7851.49 | Training tokens/sec (%): 26.71 | MFU (%): 40.92 | TFLOPs: 404.68
2025-05-19 20:11:56,066 - root - INFO - Step: 65 | Loss: 9.91 | Tokens/sec: 7869.20 | Training tokens/sec (%): 24.18 | MFU (%): 41.01 | TFLOPs: 405.59
2025-05-19 20:11:58,712 - root - INFO - Step: 70 | Loss: 9.51 | Tokens/sec: 7869.29 | Training tokens/sec (%): 26.25 | MFU (%): 41.01 | TFLOPs: 405.59
2025-05-19 20:12:01,335 - root - INFO - Step: 75 | Loss: 9.31 | Tokens/sec: 7937.44 | Training tokens/sec (%): 16.89 | MFU (%): 41.37 | TFLOPs: 409.11
2025-05-19 20:12:03,952 - root - INFO - Step: 80 | Loss: 9.41 | Tokens/sec: 7957.77 | Training tokens/sec (%): 17.36 | MFU (%): 41.47 | TFLOPs: 410.15
2025-05-19 20:12:06,569 - root - INFO - Step: 85 | Loss: 9.59 | Tokens/sec: 7960.66 | Training tokens/sec (%): 16.04 | MFU (%): 41.49 | TFLOPs: 410.30
2025-05-19 20:12:09,333 - root - INFO - Step: 90 | Loss: 9.02 | Tokens/sec: 7527.44 | Training tokens/sec (%): 57.98 | MFU (%): 39.23 | TFLOPs: 387.97
2025-05-19 20:12:12,083 - root - INFO - Step: 95 | Loss: 8.82 | Tokens/sec: 7566.44 | Training tokens/sec (%): 57.90 | MFU (%): 39.43 | TFLOPs: 389.98
2025-05-19 20:12:14,947 - root - INFO - Step: 100 | Loss: 8.93 | Tokens/sec: 7261.49 | Training tokens/sec (%): 93.89 | MFU (%): 37.84 | TFLOPs: 374.27
2025-05-19 20:12:17,573 - root - INFO - Step: 105 | Loss: 9.19 | Tokens/sec: 7929.03 | Training tokens/sec (%): 17.91 | MFU (%): 41.32 | TFLOPs: 408.67
2025-05-19 20:12:20,214 - root - INFO - Step: 110 | Loss: 9.32 | Tokens/sec: 7886.95 | Training tokens/sec (%): 25.76 | MFU (%): 41.10 | TFLOPs: 406.50
2025-05-19 20:12:22,804 - root - INFO - Step: 115 | Loss: 9.13 | Tokens/sec: 8041.82 | Training tokens/sec (%): 9.98 | MFU (%): 41.91 | TFLOPs: 414.49
2025-05-19 20:12:25,456 - root - INFO - Step: 120 | Loss: 9.02 | Tokens/sec: 7852.10 | Training tokens/sec (%): 26.43 | MFU (%): 40.92 | TFLOPs: 404.71
2025-05-19 20:12:28,096 - root - INFO - Step: 125 | Loss: 9.29 | Tokens/sec: 7887.07 | Training tokens/sec (%): 24.73 | MFU (%): 41.10 | TFLOPs: 406.51
2025-05-19 20:12:30,716 - root - INFO - Step: 130 | Loss: 9.55 | Tokens/sec: 7948.10 | Training tokens/sec (%): 17.81 | MFU (%): 41.42 | TFLOPs: 409.65
2025-05-19 20:12:33,345 - root - INFO - Step: 135 | Loss: 8.88 | Tokens/sec: 7920.41 | Training tokens/sec (%): 21.95 | MFU (%): 41.28 | TFLOPs: 408.23
2025-05-19 20:12:35,941 - root - INFO - Step: 140 | Loss: 8.80 | Tokens/sec: 8022.90 | Training tokens/sec (%): 11.89 | MFU (%): 41.81 | TFLOPs: 413.51
2025-05-19 20:12:38,586 - root - INFO - Step: 145 | Loss: 8.74 | Tokens/sec: 7874.02 | Training tokens/sec (%): 26.10 | MFU (%): 41.04 | TFLOPs: 405.84
2025-05-19 20:12:41,212 - root - INFO - Step: 150 | Loss: 9.08 | Tokens/sec: 7930.53 | Training tokens/sec (%): 19.74 | MFU (%): 41.33 | TFLOPs: 408.75
2025-05-19 20:12:43,896 - root - INFO - Step: 155 | Loss: 8.87 | Tokens/sec: 7756.31 | Training tokens/sec (%): 37.10 | MFU (%): 40.42 | TFLOPs: 399.77
2025-05-19 20:12:46,530 - root - INFO - Step: 160 | Loss: 8.32 | Tokens/sec: 7903.61 | Training tokens/sec (%): 22.84 | MFU (%): 41.19 | TFLOPs: 407.36
2025-05-19 20:12:49,167 - root - INFO - Step: 165 | Loss: 8.62 | Tokens/sec: 7896.82 | Training tokens/sec (%): 26.44 | MFU (%): 41.15 | TFLOPs: 407.01
2025-05-19 20:12:51,854 - root - INFO - Step: 170 | Loss: 8.99 | Tokens/sec: 7748.70 | Training tokens/sec (%): 39.34 | MFU (%): 40.38 | TFLOPs: 399.38
2025-05-19 20:12:54,476 - root - INFO - Step: 175 | Loss: 8.86 | Tokens/sec: 7941.02 | Training tokens/sec (%): 19.59 | MFU (%): 41.38 | TFLOPs: 409.29
2025-05-19 20:12:57,081 - root - INFO - Step: 180 | Loss: 8.56 | Tokens/sec: 7997.03 | Training tokens/sec (%): 14.69 | MFU (%): 41.68 | TFLOPs: 412.18
2025-05-19 20:12:59,688 - root - INFO - Step: 185 | Loss: 8.87 | Tokens/sec: 7990.21 | Training tokens/sec (%): 13.71 | MFU (%): 41.64 | TFLOPs: 411.82
2025-05-19 20:13:02,318 - root - INFO - Step: 190 | Loss: 8.51 | Tokens/sec: 7916.36 | Training tokens/sec (%): 21.21 | MFU (%): 41.26 | TFLOPs: 408.02
2025-05-19 20:13:05,005 - root - INFO - Step: 195 | Loss: 8.51 | Tokens/sec: 7746.48 | Training tokens/sec (%): 42.67 | MFU (%): 40.37 | TFLOPs: 399.26
2025-05-19 20:13:07,618 - root - INFO - Step: 200 | Loss: 8.82 | Tokens/sec: 7972.54 | Training tokens/sec (%): 16.92 | MFU (%): 41.55 | TFLOPs: 410.91
2025-05-19 20:13:10,205 - root - INFO - Step: 205 | Loss: 7.84 | Tokens/sec: 8051.39 | Training tokens/sec (%): 9.70 | MFU (%): 41.96 | TFLOPs: 414.98
2025-05-19 20:13:12,832 - root - INFO - Step: 210 | Loss: 8.64 | Tokens/sec: 7926.22 | Training tokens/sec (%): 19.35 | MFU (%): 41.31 | TFLOPs: 408.53
2025-05-19 20:13:15,429 - root - INFO - Step: 215 | Loss: 8.36 | Tokens/sec: 8020.12 | Training tokens/sec (%): 12.01 | MFU (%): 41.80 | TFLOPs: 413.37
2025-05-19 20:13:18,022 - root - INFO - Step: 220 | Loss: 8.60 | Tokens/sec: 8034.38 | Training tokens/sec (%): 12.01 | MFU (%): 41.87 | TFLOPs: 414.10
2025-05-19 20:13:20,664 - root - INFO - Step: 225 | Loss: 8.10 | Tokens/sec: 7882.12 | Training tokens/sec (%): 25.42 | MFU (%): 41.08 | TFLOPs: 406.25
2025-05-19 20:13:23,239 - root - INFO - Step: 230 | Loss: 8.07 | Tokens/sec: 8088.75 | Training tokens/sec (%): 6.27 | MFU (%): 42.15 | TFLOPs: 416.90
2025-05-19 20:13:25,845 - root - INFO - Step: 235 | Loss: 8.40 | Tokens/sec: 7992.31 | Training tokens/sec (%): 13.84 | MFU (%): 41.65 | TFLOPs: 411.93
2025-05-19 20:13:28,494 - root - INFO - Step: 240 | Loss: 8.15 | Tokens/sec: 7860.64 | Training tokens/sec (%): 28.71 | MFU (%): 40.97 | TFLOPs: 405.15
2025-05-19 20:13:31,155 - root - INFO - Step: 245 | Loss: 8.31 | Tokens/sec: 7825.15 | Training tokens/sec (%): 31.89 | MFU (%): 40.78 | TFLOPs: 403.32
2025-05-19 20:13:33,828 - root - INFO - Step: 250 | Loss: 8.37 | Tokens/sec: 7786.57 | Training tokens/sec (%): 35.94 | MFU (%): 40.58 | TFLOPs: 401.33
2025-05-19 20:13:36,413 - root - INFO - Step: 255 | Loss: 9.01 | Tokens/sec: 8060.40 | Training tokens/sec (%): 11.16 | MFU (%): 42.01 | TFLOPs: 415.44
2025-05-19 20:13:39,063 - root - INFO - Step: 260 | Loss: 9.36 | Tokens/sec: 7855.25 | Training tokens/sec (%): 30.02 | MFU (%): 40.94 | TFLOPs: 404.87
2025-05-19 20:13:41,661 - root - INFO - Step: 265 | Loss: 8.40 | Tokens/sec: 8017.44 | Training tokens/sec (%): 12.67 | MFU (%): 41.78 | TFLOPs: 413.23
2025-05-19 20:13:44,282 - root - INFO - Step: 270 | Loss: 8.20 | Tokens/sec: 7946.97 | Training tokens/sec (%): 17.27 | MFU (%): 41.42 | TFLOPs: 409.60
2025-05-19 20:13:46,887 - root - INFO - Step: 275 | Loss: 8.44 | Tokens/sec: 7994.28 | Training tokens/sec (%): 13.21 | MFU (%): 41.66 | TFLOPs: 412.03
2025-05-19 20:13:49,544 - root - INFO - Step: 280 | Loss: 8.02 | Tokens/sec: 7836.75 | Training tokens/sec (%): 27.62 | MFU (%): 40.84 | TFLOPs: 403.92
2025-05-19 20:13:52,176 - root - INFO - Step: 285 | Loss: 8.56 | Tokens/sec: 7912.71 | Training tokens/sec (%): 21.59 | MFU (%): 41.24 | TFLOPs: 407.83
2025-05-19 20:13:54,779 - root - INFO - Step: 290 | Loss: 8.06 | Tokens/sec: 8001.03 | Training tokens/sec (%): 13.66 | MFU (%): 41.70 | TFLOPs: 412.38
2025-05-19 20:13:57,373 - root - INFO - Step: 295 | Loss: 7.81 | Tokens/sec: 8031.33 | Training tokens/sec (%): 11.15 | MFU (%): 41.85 | TFLOPs: 413.94
2025-05-19 20:14:00,118 - root - INFO - Step: 300 | Loss: 7.93 | Tokens/sec: 7579.27 | Training tokens/sec (%): 54.36 | MFU (%): 39.50 | TFLOPs: 390.64
2025-05-19 20:14:02,752 - root - INFO - Step: 305 | Loss: 8.88 | Tokens/sec: 7905.78 | Training tokens/sec (%): 21.34 | MFU (%): 41.20 | TFLOPs: 407.47
2025-05-19 20:14:05,364 - root - INFO - Step: 310 | Loss: 8.49 | Tokens/sec: 7973.38 | Training tokens/sec (%): 15.84 | MFU (%): 41.55 | TFLOPs: 410.96
2025-05-19 20:14:08,019 - root - INFO - Step: 315 | Loss: 7.78 | Tokens/sec: 7843.56 | Training tokens/sec (%): 28.90 | MFU (%): 40.88 | TFLOPs: 404.27
2025-05-19 20:14:10,681 - root - INFO - Step: 320 | Loss: 8.46 | Tokens/sec: 7822.02 | Training tokens/sec (%): 31.73 | MFU (%): 40.76 | TFLOPs: 403.16
2025-05-19 20:14:13,328 - root - INFO - Step: 325 | Loss: 8.08 | Tokens/sec: 7866.47 | Training tokens/sec (%): 27.17 | MFU (%): 41.00 | TFLOPs: 405.45
2025-05-19 20:14:15,984 - root - INFO - Step: 330 | Loss: 7.30 | Tokens/sec: 7837.04 | Training tokens/sec (%): 30.51 | MFU (%): 40.84 | TFLOPs: 403.93
2025-05-19 20:14:18,559 - root - INFO - Step: 335 | Loss: 8.50 | Tokens/sec: 8089.82 | Training tokens/sec (%): 6.10 | MFU (%): 42.16 | TFLOPs: 416.96
2025-05-19 20:14:21,173 - root - INFO - Step: 340 | Loss: 8.43 | Tokens/sec: 7968.41 | Training tokens/sec (%): 16.78 | MFU (%): 41.53 | TFLOPs: 410.70
2025-05-19 20:14:23,795 - root - INFO - Step: 345 | Loss: 8.21 | Tokens/sec: 7942.07 | Training tokens/sec (%): 19.16 | MFU (%): 41.39 | TFLOPs: 409.34
2025-05-19 20:14:26,417 - root - INFO - Step: 350 | Loss: 8.33 | Tokens/sec: 7944.83 | Training tokens/sec (%): 19.25 | MFU (%): 41.40 | TFLOPs: 409.49
2025-05-19 20:14:29,003 - root - INFO - Step: 355 | Loss: 8.28 | Tokens/sec: 8054.10 | Training tokens/sec (%): 9.23 | MFU (%): 41.97 | TFLOPs: 415.12
2025-05-19 20:14:31,648 - root - INFO - Step: 360 | Loss: 7.80 | Tokens/sec: 7871.15 | Training tokens/sec (%): 25.02 | MFU (%): 41.02 | TFLOPs: 405.69
2025-05-19 20:14:34,276 - root - INFO - Step: 365 | Loss: 8.04 | Tokens/sec: 7925.84 | Training tokens/sec (%): 20.51 | MFU (%): 41.31 | TFLOPs: 408.51
2025-05-19 20:14:36,897 - root - INFO - Step: 370 | Loss: 7.56 | Tokens/sec: 7943.63 | Training tokens/sec (%): 17.57 | MFU (%): 41.40 | TFLOPs: 409.42
2025-05-19 20:14:39,648 - root - INFO - Step: 375 | Loss: 8.33 | Tokens/sec: 7565.29 | Training tokens/sec (%): 56.57 | MFU (%): 39.43 | TFLOPs: 389.92
2025-05-19 20:14:42,331 - root - INFO - Step: 380 | Loss: 7.41 | Tokens/sec: 7759.71 | Training tokens/sec (%): 34.63 | MFU (%): 40.44 | TFLOPs: 399.94
2025-05-19 20:14:44,947 - root - INFO - Step: 385 | Loss: 7.96 | Tokens/sec: 7960.45 | Training tokens/sec (%): 17.60 | MFU (%): 41.49 | TFLOPs: 410.29
2025-05-19 20:14:47,584 - root - INFO - Step: 390 | Loss: 7.70 | Tokens/sec: 7895.77 | Training tokens/sec (%): 23.14 | MFU (%): 41.15 | TFLOPs: 406.96
2025-05-19 20:14:50,225 - root - INFO - Step: 395 | Loss: 8.11 | Tokens/sec: 7887.40 | Training tokens/sec (%): 22.83 | MFU (%): 41.10 | TFLOPs: 406.53
2025-05-19 20:14:52,868 - root - INFO - Step: 400 | Loss: 7.57 | Tokens/sec: 7876.16 | Training tokens/sec (%): 28.39 | MFU (%): 41.05 | TFLOPs: 405.95
2025-05-19 20:14:55,470 - root - INFO - Step: 405 | Loss: 7.93 | Tokens/sec: 8006.98 | Training tokens/sec (%): 13.37 | MFU (%): 41.73 | TFLOPs: 412.69
2025-05-19 20:14:58,084 - root - INFO - Step: 410 | Loss: 8.19 | Tokens/sec: 7967.42 | Training tokens/sec (%): 17.92 | MFU (%): 41.52 | TFLOPs: 410.65
2025-05-19 20:15:00,756 - root - INFO - Step: 415 | Loss: 8.01 | Tokens/sec: 7791.17 | Training tokens/sec (%): 31.84 | MFU (%): 40.60 | TFLOPs: 401.57
2025-05-19 20:15:03,356 - root - INFO - Step: 420 | Loss: 8.10 | Tokens/sec: 8010.48 | Training tokens/sec (%): 13.01 | MFU (%): 41.75 | TFLOPs: 412.87
2025-05-19 20:15:05,949 - root - INFO - Step: 425 | Loss: 8.01 | Tokens/sec: 8034.02 | Training tokens/sec (%): 10.23 | MFU (%): 41.87 | TFLOPs: 414.08
2025-05-19 20:15:08,588 - root - INFO - Step: 430 | Loss: 8.57 | Tokens/sec: 7888.80 | Training tokens/sec (%): 23.21 | MFU (%): 41.11 | TFLOPs: 406.60
2025-05-19 20:15:11,302 - root - INFO - Step: 435 | Loss: 8.04 | Tokens/sec: 7668.56 | Training tokens/sec (%): 48.59 | MFU (%): 39.96 | TFLOPs: 395.25
2025-05-19 20:15:13,911 - root - INFO - Step: 440 | Loss: 7.79 | Tokens/sec: 7982.88 | Training tokens/sec (%): 14.97 | MFU (%): 41.60 | TFLOPs: 411.45
2025-05-19 20:15:16,555 - root - INFO - Step: 445 | Loss: 7.45 | Tokens/sec: 7876.75 | Training tokens/sec (%): 24.81 | MFU (%): 41.05 | TFLOPs: 405.98
2025-05-19 20:15:19,205 - root - INFO - Step: 450 | Loss: 7.96 | Tokens/sec: 7857.79 | Training tokens/sec (%): 26.11 | MFU (%): 40.95 | TFLOPs: 405.00
2025-05-19 20:15:21,911 - root - INFO - Step: 455 | Loss: 7.41 | Tokens/sec: 7691.10 | Training tokens/sec (%): 44.85 | MFU (%): 40.08 | TFLOPs: 396.41
2025-05-19 20:15:24,539 - root - INFO - Step: 460 | Loss: 7.70 | Tokens/sec: 7925.40 | Training tokens/sec (%): 20.43 | MFU (%): 41.30 | TFLOPs: 408.48
2025-05-19 20:15:27,185 - root - INFO - Step: 465 | Loss: 7.72 | Tokens/sec: 7868.09 | Training tokens/sec (%): 24.75 | MFU (%): 41.00 | TFLOPs: 405.53
2025-05-19 20:15:29,828 - root - INFO - Step: 470 | Loss: 7.74 | Tokens/sec: 7880.28 | Training tokens/sec (%): 24.22 | MFU (%): 41.07 | TFLOPs: 406.16
2025-05-19 20:15:32,486 - root - INFO - Step: 475 | Loss: 7.98 | Tokens/sec: 7833.07 | Training tokens/sec (%): 27.67 | MFU (%): 40.82 | TFLOPs: 403.73
2025-05-19 20:15:35,140 - root - INFO - Step: 480 | Loss: 7.49 | Tokens/sec: 7843.09 | Training tokens/sec (%): 28.85 | MFU (%): 40.87 | TFLOPs: 404.24
2025-05-19 20:15:37,742 - root - INFO - Step: 485 | Loss: 7.92 | Tokens/sec: 8007.50 | Training tokens/sec (%): 12.13 | MFU (%): 41.73 | TFLOPs: 412.72
2025-05-19 20:15:40,352 - root - INFO - Step: 490 | Loss: 8.21 | Tokens/sec: 7976.90 | Training tokens/sec (%): 15.93 | MFU (%): 41.57 | TFLOPs: 411.14
2025-05-19 20:15:42,992 - root - INFO - Step: 495 | Loss: 8.26 | Tokens/sec: 7890.17 | Training tokens/sec (%): 26.74 | MFU (%): 41.12 | TFLOPs: 406.67
2025-05-19 20:15:45,653 - root - INFO - Step: 500 | Loss: 8.48 | Tokens/sec: 7822.54 | Training tokens/sec (%): 29.65 | MFU (%): 40.77 | TFLOPs: 403.18
2025-05-19 20:15:48,269 - root - INFO - Step: 505 | Loss: 7.79 | Tokens/sec: 7962.37 | Training tokens/sec (%): 16.09 | MFU (%): 41.50 | TFLOPs: 410.39
2025-05-19 20:15:50,887 - root - INFO - Step: 510 | Loss: 8.44 | Tokens/sec: 7954.68 | Training tokens/sec (%): 16.85 | MFU (%): 41.46 | TFLOPs: 409.99
2025-05-19 20:15:53,511 - root - INFO - Step: 515 | Loss: 6.97 | Tokens/sec: 7935.08 | Training tokens/sec (%): 19.05 | MFU (%): 41.35 | TFLOPs: 408.98
2025-05-19 20:15:56,135 - root - INFO - Step: 520 | Loss: 7.49 | Tokens/sec: 7938.11 | Training tokens/sec (%): 18.01 | MFU (%): 41.37 | TFLOPs: 409.14
2025-05-19 20:15:58,791 - root - INFO - Step: 525 | Loss: 7.80 | Tokens/sec: 7837.54 | Training tokens/sec (%): 28.13 | MFU (%): 40.84 | TFLOPs: 403.96
2025-05-19 20:16:01,441 - root - INFO - Step: 530 | Loss: 7.77 | Tokens/sec: 7857.95 | Training tokens/sec (%): 26.11 | MFU (%): 40.95 | TFLOPs: 405.01
2025-05-19 20:16:04,166 - root - INFO - Step: 535 | Loss: 8.11 | Tokens/sec: 7637.34 | Training tokens/sec (%): 51.25 | MFU (%): 39.80 | TFLOPs: 393.64
2025-05-19 20:16:06,816 - root - INFO - Step: 540 | Loss: 6.22 | Tokens/sec: 7857.78 | Training tokens/sec (%): 28.41 | MFU (%): 40.95 | TFLOPs: 405.00
2025-05-19 20:16:09,507 - root - INFO - Step: 545 | Loss: 7.71 | Tokens/sec: 7734.94 | Training tokens/sec (%): 38.98 | MFU (%): 40.31 | TFLOPs: 398.67
2025-05-19 20:16:12,099 - root - INFO - Step: 550 | Loss: 7.98 | Tokens/sec: 8037.33 | Training tokens/sec (%): 10.88 | MFU (%): 41.89 | TFLOPs: 414.25
2025-05-19 20:16:14,701 - root - INFO - Step: 555 | Loss: 9.49 | Tokens/sec: 8004.24 | Training tokens/sec (%): 13.59 | MFU (%): 41.71 | TFLOPs: 412.55
2025-05-19 20:16:17,331 - root - INFO - Step: 560 | Loss: 8.29 | Tokens/sec: 7917.52 | Training tokens/sec (%): 21.19 | MFU (%): 41.26 | TFLOPs: 408.08
2025-05-19 20:16:19,926 - root - INFO - Step: 565 | Loss: 7.82 | Tokens/sec: 8029.36 | Training tokens/sec (%): 10.85 | MFU (%): 41.84 | TFLOPs: 413.84
2025-05-19 20:16:22,516 - root - INFO - Step: 570 | Loss: 8.34 | Tokens/sec: 8040.33 | Training tokens/sec (%): 9.92 | MFU (%): 41.90 | TFLOPs: 414.41
2025-05-19 20:16:25,110 - root - INFO - Step: 575 | Loss: 7.53 | Tokens/sec: 8029.24 | Training tokens/sec (%): 11.96 | MFU (%): 41.84 | TFLOPs: 413.84
2025-05-19 20:16:27,693 - root - INFO - Step: 580 | Loss: 8.14 | Tokens/sec: 8065.66 | Training tokens/sec (%): 7.41 | MFU (%): 42.03 | TFLOPs: 415.71
2025-05-19 20:16:30,311 - root - INFO - Step: 585 | Loss: 7.34 | Tokens/sec: 7956.25 | Training tokens/sec (%): 16.47 | MFU (%): 41.46 | TFLOPs: 410.07
2025-05-19 20:16:32,924 - root - INFO - Step: 590 | Loss: 7.85 | Tokens/sec: 7970.66 | Training tokens/sec (%): 16.10 | MFU (%): 41.54 | TFLOPs: 410.82
2025-05-19 20:16:35,522 - root - INFO - Step: 595 | Loss: 8.19 | Tokens/sec: 8014.89 | Training tokens/sec (%): 11.91 | MFU (%): 41.77 | TFLOPs: 413.10
2025-05-19 20:16:38,117 - root - INFO - Step: 600 | Loss: 7.77 | Tokens/sec: 8026.02 | Training tokens/sec (%): 11.46 | MFU (%): 41.83 | TFLOPs: 413.67
2025-05-19 20:16:40,759 - root - INFO - Step: 605 | Loss: 8.02 | Tokens/sec: 7882.65 | Training tokens/sec (%): 26.98 | MFU (%): 41.08 | TFLOPs: 406.28
2025-05-19 20:16:43,374 - root - INFO - Step: 610 | Loss: 9.02 | Tokens/sec: 7965.66 | Training tokens/sec (%): 15.95 | MFU (%): 41.51 | TFLOPs: 410.56
2025-05-19 20:16:46,015 - root - INFO - Step: 615 | Loss: 7.70 | Tokens/sec: 7882.52 | Training tokens/sec (%): 23.21 | MFU (%): 41.08 | TFLOPs: 406.27
2025-05-19 20:16:48,622 - root - INFO - Step: 620 | Loss: 7.34 | Tokens/sec: 7988.80 | Training tokens/sec (%): 14.51 | MFU (%): 41.63 | TFLOPs: 411.75
2025-05-19 20:16:51,258 - root - INFO - Step: 625 | Loss: 7.57 | Tokens/sec: 7899.99 | Training tokens/sec (%): 22.61 | MFU (%): 41.17 | TFLOPs: 407.18
2025-05-19 20:16:53,861 - root - INFO - Step: 630 | Loss: 7.80 | Tokens/sec: 8002.08 | Training tokens/sec (%): 13.96 | MFU (%): 41.70 | TFLOPs: 412.44
2025-05-19 20:16:56,548 - root - INFO - Step: 635 | Loss: 8.12 | Tokens/sec: 7746.82 | Training tokens/sec (%): 36.07 | MFU (%): 40.37 | TFLOPs: 399.28
2025-05-19 20:16:59,157 - root - INFO - Step: 640 | Loss: 7.86 | Tokens/sec: 7985.14 | Training tokens/sec (%): 15.43 | MFU (%): 41.61 | TFLOPs: 411.56
2025-05-19 20:17:01,769 - root - INFO - Step: 645 | Loss: 7.75 | Tokens/sec: 7973.29 | Training tokens/sec (%): 15.98 | MFU (%): 41.55 | TFLOPs: 410.95
2025-05-19 20:17:04,475 - root - INFO - Step: 650 | Loss: 7.44 | Tokens/sec: 7691.13 | Training tokens/sec (%): 44.35 | MFU (%): 40.08 | TFLOPs: 396.41
2025-05-19 20:17:07,122 - root - INFO - Step: 655 | Loss: 7.80 | Tokens/sec: 7864.89 | Training tokens/sec (%): 27.18 | MFU (%): 40.99 | TFLOPs: 405.37
2025-05-19 20:17:09,727 - root - INFO - Step: 660 | Loss: 7.81 | Tokens/sec: 7997.25 | Training tokens/sec (%): 13.00 | MFU (%): 41.68 | TFLOPs: 412.19
2025-05-19 20:17:12,403 - root - INFO - Step: 665 | Loss: 7.69 | Tokens/sec: 7780.80 | Training tokens/sec (%): 35.04 | MFU (%): 40.55 | TFLOPs: 401.03
2025-05-19 20:17:15,024 - root - INFO - Step: 670 | Loss: 7.09 | Tokens/sec: 7943.57 | Training tokens/sec (%): 18.38 | MFU (%): 41.40 | TFLOPs: 409.42
2025-05-19 20:17:17,613 - root - INFO - Step: 675 | Loss: 7.02 | Tokens/sec: 8046.65 | Training tokens/sec (%): 9.26 | MFU (%): 41.93 | TFLOPs: 414.73
2025-05-19 20:17:20,264 - root - INFO - Step: 680 | Loss: 7.59 | Tokens/sec: 7854.97 | Training tokens/sec (%): 30.43 | MFU (%): 40.94 | TFLOPs: 404.85
2025-05-19 20:17:22,892 - root - INFO - Step: 685 | Loss: 8.35 | Tokens/sec: 7924.35 | Training tokens/sec (%): 19.60 | MFU (%): 41.30 | TFLOPs: 408.43
2025-05-19 20:17:25,471 - root - INFO - Step: 690 | Loss: 7.35 | Tokens/sec: 8075.35 | Training tokens/sec (%): 7.32 | MFU (%): 42.08 | TFLOPs: 416.21
2025-05-19 20:17:28,194 - root - INFO - Step: 695 | Loss: 7.84 | Tokens/sec: 7643.31 | Training tokens/sec (%): 49.85 | MFU (%): 39.83 | TFLOPs: 393.95
2025-05-19 20:17:30,821 - root - INFO - Step: 700 | Loss: 7.37 | Tokens/sec: 7927.12 | Training tokens/sec (%): 19.23 | MFU (%): 41.31 | TFLOPs: 408.57
2025-05-19 20:17:33,454 - root - INFO - Step: 705 | Loss: 7.65 | Tokens/sec: 7911.17 | Training tokens/sec (%): 20.72 | MFU (%): 41.23 | TFLOPs: 407.75
2025-05-19 20:17:36,134 - root - INFO - Step: 710 | Loss: 7.60 | Tokens/sec: 7765.36 | Training tokens/sec (%): 32.88 | MFU (%): 40.47 | TFLOPs: 400.24
2025-05-19 20:17:38,785 - root - INFO - Step: 715 | Loss: 7.45 | Tokens/sec: 7854.17 | Training tokens/sec (%): 29.16 | MFU (%): 40.93 | TFLOPs: 404.81
2025-05-19 20:17:41,384 - root - INFO - Step: 720 | Loss: 6.53 | Tokens/sec: 8015.58 | Training tokens/sec (%): 11.67 | MFU (%): 41.77 | TFLOPs: 413.13
2025-05-19 20:17:43,968 - root - INFO - Step: 725 | Loss: 7.65 | Tokens/sec: 8060.69 | Training tokens/sec (%): 9.85 | MFU (%): 42.01 | TFLOPs: 415.46
2025-05-19 20:17:46,562 - root - INFO - Step: 730 | Loss: 8.08 | Tokens/sec: 8029.34 | Training tokens/sec (%): 11.26 | MFU (%): 41.84 | TFLOPs: 413.84
2025-05-19 20:17:49,153 - root - INFO - Step: 735 | Loss: 7.66 | Tokens/sec: 8041.89 | Training tokens/sec (%): 9.29 | MFU (%): 41.91 | TFLOPs: 414.49
2025-05-19 20:17:51,804 - root - INFO - Step: 740 | Loss: 7.88 | Tokens/sec: 7853.73 | Training tokens/sec (%): 29.05 | MFU (%): 40.93 | TFLOPs: 404.79
2025-05-19 20:17:54,389 - root - INFO - Step: 745 | Loss: 7.86 | Tokens/sec: 8056.80 | Training tokens/sec (%): 9.51 | MFU (%): 41.99 | TFLOPs: 415.26
2025-05-19 20:17:57,014 - root - INFO - Step: 750 | Loss: 7.61 | Tokens/sec: 7934.89 | Training tokens/sec (%): 19.01 | MFU (%): 41.35 | TFLOPs: 408.97
2025-05-19 20:17:59,637 - root - INFO - Step: 755 | Loss: 7.51 | Tokens/sec: 7938.47 | Training tokens/sec (%): 19.92 | MFU (%): 41.37 | TFLOPs: 409.16
2025-05-19 20:18:02,322 - root - INFO - Step: 760 | Loss: 7.86 | Tokens/sec: 7753.57 | Training tokens/sec (%): 35.18 | MFU (%): 40.41 | TFLOPs: 399.63
2025-05-19 20:18:05,056 - root - INFO - Step: 765 | Loss: 7.49 | Tokens/sec: 7610.60 | Training tokens/sec (%): 55.83 | MFU (%): 39.66 | TFLOPs: 392.26
2025-05-19 20:18:07,681 - root - INFO - Step: 770 | Loss: 7.29 | Tokens/sec: 7934.06 | Training tokens/sec (%): 18.56 | MFU (%): 41.35 | TFLOPs: 408.93
2025-05-19 20:18:10,334 - root - INFO - Step: 775 | Loss: 7.25 | Tokens/sec: 7849.95 | Training tokens/sec (%): 29.94 | MFU (%): 40.91 | TFLOPs: 404.60
2025-05-19 20:18:12,932 - root - INFO - Step: 780 | Loss: 8.29 | Tokens/sec: 8016.60 | Training tokens/sec (%): 12.24 | MFU (%): 41.78 | TFLOPs: 413.19
2025-05-19 20:18:15,546 - root - INFO - Step: 785 | Loss: 7.70 | Tokens/sec: 7967.39 | Training tokens/sec (%): 17.48 | MFU (%): 41.52 | TFLOPs: 410.65
2025-05-19 20:18:18,170 - root - INFO - Step: 790 | Loss: 7.62 | Tokens/sec: 7937.40 | Training tokens/sec (%): 18.63 | MFU (%): 41.37 | TFLOPs: 409.10
2025-05-19 20:18:20,867 - root - INFO - Step: 795 | Loss: 7.11 | Tokens/sec: 7715.98 | Training tokens/sec (%): 44.50 | MFU (%): 40.21 | TFLOPs: 397.69
2025-05-19 20:18:23,517 - root - INFO - Step: 800 | Loss: 7.47 | Tokens/sec: 7859.29 | Training tokens/sec (%): 25.66 | MFU (%): 40.96 | TFLOPs: 405.08
2025-05-19 20:18:26,199 - root - INFO - Step: 805 | Loss: 7.46 | Tokens/sec: 7760.80 | Training tokens/sec (%): 38.37 | MFU (%): 40.45 | TFLOPs: 400.00
2025-05-19 20:18:28,816 - root - INFO - Step: 810 | Loss: 7.37 | Tokens/sec: 7959.49 | Training tokens/sec (%): 17.12 | MFU (%): 41.48 | TFLOPs: 410.24
2025-05-19 20:18:31,475 - root - INFO - Step: 815 | Loss: 8.22 | Tokens/sec: 7829.32 | Training tokens/sec (%): 30.96 | MFU (%): 40.80 | TFLOPs: 403.53
2025-05-19 20:18:34,101 - root - INFO - Step: 820 | Loss: 7.35 | Tokens/sec: 7929.13 | Training tokens/sec (%): 18.55 | MFU (%): 41.32 | TFLOPs: 408.68
2025-05-19 20:18:36,778 - root - INFO - Step: 825 | Loss: 7.56 | Tokens/sec: 7777.33 | Training tokens/sec (%): 32.02 | MFU (%): 40.53 | TFLOPs: 400.85
2025-05-19 20:18:39,404 - root - INFO - Step: 830 | Loss: 7.62 | Tokens/sec: 7930.17 | Training tokens/sec (%): 19.21 | MFU (%): 41.33 | TFLOPs: 408.73
2025-05-19 20:18:41,995 - root - INFO - Step: 835 | Loss: 7.79 | Tokens/sec: 8039.13 | Training tokens/sec (%): 9.45 | MFU (%): 41.90 | TFLOPs: 414.35
2025-05-19 20:18:44,581 - root - INFO - Step: 840 | Loss: 7.80 | Tokens/sec: 8055.12 | Training tokens/sec (%): 8.98 | MFU (%): 41.98 | TFLOPs: 415.17
2025-05-19 20:18:47,188 - root - INFO - Step: 845 | Loss: 8.01 | Tokens/sec: 7989.29 | Training tokens/sec (%): 14.42 | MFU (%): 41.64 | TFLOPs: 411.78
2025-05-19 20:18:49,799 - root - INFO - Step: 850 | Loss: 7.36 | Tokens/sec: 7977.79 | Training tokens/sec (%): 14.26 | MFU (%): 41.58 | TFLOPs: 411.18
2025-05-19 20:18:52,471 - root - INFO - Step: 855 | Loss: 7.81 | Tokens/sec: 7790.31 | Training tokens/sec (%): 30.06 | MFU (%): 40.60 | TFLOPs: 401.52
2025-05-19 20:18:55,055 - root - INFO - Step: 860 | Loss: 7.71 | Tokens/sec: 8060.93 | Training tokens/sec (%): 8.63 | MFU (%): 42.01 | TFLOPs: 415.47
2025-05-19 20:18:57,666 - root - INFO - Step: 865 | Loss: 6.97 | Tokens/sec: 7978.05 | Training tokens/sec (%): 15.03 | MFU (%): 41.58 | TFLOPs: 411.20
2025-05-19 20:19:00,304 - root - INFO - Step: 870 | Loss: 7.46 | Tokens/sec: 7894.13 | Training tokens/sec (%): 22.24 | MFU (%): 41.14 | TFLOPs: 406.87
2025-05-19 20:19:02,912 - root - INFO - Step: 875 | Loss: 7.62 | Tokens/sec: 7984.31 | Training tokens/sec (%): 13.85 | MFU (%): 41.61 | TFLOPs: 411.52
2025-05-19 20:19:05,523 - root - INFO - Step: 880 | Loss: 8.02 | Tokens/sec: 7976.97 | Training tokens/sec (%): 15.41 | MFU (%): 41.57 | TFLOPs: 411.14
2025-05-19 20:19:08,194 - root - INFO - Step: 885 | Loss: 7.02 | Tokens/sec: 7794.33 | Training tokens/sec (%): 31.47 | MFU (%): 40.62 | TFLOPs: 401.73
2025-05-19 20:19:10,835 - root - INFO - Step: 890 | Loss: 7.26 | Tokens/sec: 7885.43 | Training tokens/sec (%): 23.38 | MFU (%): 41.09 | TFLOPs: 406.42
2025-05-19 20:19:13,434 - root - INFO - Step: 895 | Loss: 7.97 | Tokens/sec: 8016.01 | Training tokens/sec (%): 12.66 | MFU (%): 41.78 | TFLOPs: 413.15
2025-05-19 20:19:16,039 - root - INFO - Step: 900 | Loss: 7.84 | Tokens/sec: 7995.00 | Training tokens/sec (%): 14.21 | MFU (%): 41.67 | TFLOPs: 412.07
2025-05-19 20:19:18,638 - root - INFO - Step: 905 | Loss: 7.95 | Tokens/sec: 8012.08 | Training tokens/sec (%): 11.89 | MFU (%): 41.75 | TFLOPs: 412.95
2025-05-19 20:19:21,292 - root - INFO - Step: 910 | Loss: 7.25 | Tokens/sec: 7845.14 | Training tokens/sec (%): 27.29 | MFU (%): 40.88 | TFLOPs: 404.35
2025-05-19 20:19:23,890 - root - INFO - Step: 915 | Loss: 7.66 | Tokens/sec: 8018.27 | Training tokens/sec (%): 12.34 | MFU (%): 41.79 | TFLOPs: 413.27
2025-05-19 20:19:26,524 - root - INFO - Step: 920 | Loss: 7.28 | Tokens/sec: 7906.79 | Training tokens/sec (%): 19.49 | MFU (%): 41.21 | TFLOPs: 407.53
2025-05-19 20:19:29,119 - root - INFO - Step: 925 | Loss: 7.16 | Tokens/sec: 8027.51 | Training tokens/sec (%): 10.24 | MFU (%): 41.83 | TFLOPs: 413.75
2025-05-19 20:19:31,766 - root - INFO - Step: 930 | Loss: 7.23 | Tokens/sec: 7864.09 | Training tokens/sec (%): 26.54 | MFU (%): 40.98 | TFLOPs: 405.32
2025-05-19 20:19:34,372 - root - INFO - Step: 935 | Loss: 7.85 | Tokens/sec: 7991.71 | Training tokens/sec (%): 13.64 | MFU (%): 41.65 | TFLOPs: 411.90
2025-05-19 20:19:37,002 - root - INFO - Step: 940 | Loss: 7.19 | Tokens/sec: 7919.64 | Training tokens/sec (%): 20.20 | MFU (%): 41.27 | TFLOPs: 408.19
2025-05-19 20:19:39,647 - root - INFO - Step: 945 | Loss: 7.73 | Tokens/sec: 7872.32 | Training tokens/sec (%): 28.11 | MFU (%): 41.03 | TFLOPs: 405.75
2025-05-19 20:19:42,372 - root - INFO - Step: 950 | Loss: 7.22 | Tokens/sec: 7637.72 | Training tokens/sec (%): 46.25 | MFU (%): 39.80 | TFLOPs: 393.66
2025-05-19 20:19:44,982 - root - INFO - Step: 955 | Loss: 7.28 | Tokens/sec: 7978.41 | Training tokens/sec (%): 14.33 | MFU (%): 41.58 | TFLOPs: 411.22
2025-05-19 20:19:47,661 - root - INFO - Step: 960 | Loss: 7.59 | Tokens/sec: 7771.58 | Training tokens/sec (%): 34.03 | MFU (%): 40.50 | TFLOPs: 400.56
2025-05-19 20:19:50,270 - root - INFO - Step: 965 | Loss: 7.70 | Tokens/sec: 7983.77 | Training tokens/sec (%): 14.93 | MFU (%): 41.61 | TFLOPs: 411.49
2025-05-19 20:19:52,855 - root - INFO - Step: 970 | Loss: 7.40 | Tokens/sec: 8057.41 | Training tokens/sec (%): 9.15 | MFU (%): 41.99 | TFLOPs: 415.29
2025-05-19 20:19:55,464 - root - INFO - Step: 975 | Loss: 6.95 | Tokens/sec: 7983.72 | Training tokens/sec (%): 15.41 | MFU (%): 41.61 | TFLOPs: 411.49
2025-05-19 20:19:58,160 - root - INFO - Step: 980 | Loss: 8.03 | Tokens/sec: 7720.95 | Training tokens/sec (%): 41.17 | MFU (%): 40.24 | TFLOPs: 397.95
2025-05-19 20:20:00,775 - root - INFO - Step: 985 | Loss: 7.32 | Tokens/sec: 7963.67 | Training tokens/sec (%): 16.06 | MFU (%): 41.50 | TFLOPs: 410.46
2025-05-19 20:20:03,376 - root - INFO - Step: 990 | Loss: 7.64 | Tokens/sec: 8009.29 | Training tokens/sec (%): 12.10 | MFU (%): 41.74 | TFLOPs: 412.81
2025-05-19 20:20:06,077 - root - INFO - Step: 995 | Loss: 7.88 | Tokens/sec: 7706.51 | Training tokens/sec (%): 46.52 | MFU (%): 40.16 | TFLOPs: 397.20
2025-05-19 20:20:08,703 - root - INFO - Step: 1000 | Loss: 6.99 | Tokens/sec: 7929.79 | Training tokens/sec (%): 18.49 | MFU (%): 41.33 | TFLOPs: 408.71
2025-05-19 20:20:08,703 - root - INFO - Training completed
2025-05-19 20:20:08,704 - root - INFO - === Average performance over training ===
2025-05-19 20:20:08,704 - root - INFO -   Avg Tokens/sec:      7893.10
2025-05-19 20:20:08,704 - root - INFO -   Avg Train Token %:   22.59
2025-05-19 20:20:08,704 - root - INFO -   Avg MFU %:           41.13
2025-05-19 20:20:08,704 - root - INFO -   Avg TFLOPs:          406.82
2025-05-19 20:20:08,704 - root - INFO - Total training time: 528.15 seconds
2025-05-19 20:20:08,705 - root - INFO - Measuring speed of current model...
2025-05-19 20:20:16,942 - root - INFO - [Speed] Avg inference time: 150.28 ms | Max GPU memory: 31.10 GB
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
slurmstepd: error: couldn't chdir to `/workspace': No such file or directory: going to /tmp instead
2025-05-19 20:20:31,405 - root - INFO - Experiment args: Namespace(save_speed_key='baseline', speed_results_path='/users/goymak/scratch/fast_attention_v3/speed_results.json', disable_pytorch_flash=False, save_path=None, reference_model_path='/users/goymak/scratch/fast_attention_v3/baseline_model/model.pt', use_flash_attn=True, dataset='/capstor/store/cscs/ethz/large-sc/datasets/train_data.parquet', tokenizer_name_or_path='unsloth/Mistral-Nemo-Base-2407-bnb-4bit', sequence_length=4096, batch_size=1, fused_optimizer=False, learning_rate=1e-05, lr_warmup_steps=10, training_steps=1000, logging_frequency=5, profile=False, profile_step_start=10, profile_step_end=12, grad_max_norm=1, model_dtype='bf16', compile=True)
2025-05-19 20:20:31,405 - root - INFO - Setting up DataLoaders...
2025-05-19 20:20:32,560 - root - INFO - Setting up Model...
2025-05-19 20:21:09,475 - root - WARNING - ⚠️ Skipping torch.compile because FlashAttention3 is incompatible with TorchDynamo.
2025-05-19 20:21:10,775 - root - INFO - Running with FlashAttention
2025-05-19 20:21:10,775 - root - INFO - Starting training!
2025-05-19 20:21:13,600 - root - INFO - Step: 5 | Loss: 11.92 | Tokens/sec: 7361.62 | Training tokens/sec (%): 13.01 | MFU (%): 38.36 | TFLOPs: 379.43
2025-05-19 20:21:16,175 - root - INFO - Step: 10 | Loss: 11.86 | Tokens/sec: 8090.69 | Training tokens/sec (%): 25.72 | MFU (%): 42.16 | TFLOPs: 417.00
2025-05-19 20:21:18,777 - root - INFO - Step: 15 | Loss: 11.37 | Tokens/sec: 8007.09 | Training tokens/sec (%): 35.21 | MFU (%): 41.73 | TFLOPs: 412.70
2025-05-19 20:21:21,379 - root - INFO - Step: 20 | Loss: 10.90 | Tokens/sec: 8004.16 | Training tokens/sec (%): 34.78 | MFU (%): 41.71 | TFLOPs: 412.54
2025-05-19 20:21:23,929 - root - INFO - Step: 25 | Loss: 10.62 | Tokens/sec: 8170.78 | Training tokens/sec (%): 18.28 | MFU (%): 42.58 | TFLOPs: 421.13
2025-05-19 20:21:26,512 - root - INFO - Step: 30 | Loss: 9.81 | Tokens/sec: 8064.56 | Training tokens/sec (%): 26.99 | MFU (%): 42.03 | TFLOPs: 415.66
2025-05-19 20:21:29,043 - root - INFO - Step: 35 | Loss: 9.89 | Tokens/sec: 8235.31 | Training tokens/sec (%): 13.78 | MFU (%): 42.92 | TFLOPs: 424.46
2025-05-19 20:21:31,563 - root - INFO - Step: 40 | Loss: 10.13 | Tokens/sec: 8267.18 | Training tokens/sec (%): 9.95 | MFU (%): 43.08 | TFLOPs: 426.10
2025-05-19 20:21:34,110 - root - INFO - Step: 45 | Loss: 9.62 | Tokens/sec: 8183.65 | Training tokens/sec (%): 15.59 | MFU (%): 42.65 | TFLOPs: 421.79
2025-05-19 20:21:36,625 - root - INFO - Step: 50 | Loss: 9.59 | Tokens/sec: 8283.91 | Training tokens/sec (%): 10.93 | MFU (%): 43.17 | TFLOPs: 426.96
2025-05-19 20:21:39,213 - root - INFO - Step: 55 | Loss: 10.05 | Tokens/sec: 8049.56 | Training tokens/sec (%): 28.32 | MFU (%): 41.95 | TFLOPs: 414.88
2025-05-19 20:21:41,793 - root - INFO - Step: 60 | Loss: 9.59 | Tokens/sec: 8075.30 | Training tokens/sec (%): 26.71 | MFU (%): 42.08 | TFLOPs: 416.21
2025-05-19 20:21:44,367 - root - INFO - Step: 65 | Loss: 9.91 | Tokens/sec: 8093.81 | Training tokens/sec (%): 24.18 | MFU (%): 42.18 | TFLOPs: 417.16
2025-05-19 20:21:46,937 - root - INFO - Step: 70 | Loss: 9.52 | Tokens/sec: 8104.13 | Training tokens/sec (%): 26.25 | MFU (%): 42.23 | TFLOPs: 417.70
2025-05-19 20:21:49,487 - root - INFO - Step: 75 | Loss: 9.36 | Tokens/sec: 8171.33 | Training tokens/sec (%): 16.89 | MFU (%): 42.58 | TFLOPs: 421.16
2025-05-19 20:21:52,030 - root - INFO - Step: 80 | Loss: 9.33 | Tokens/sec: 8195.21 | Training tokens/sec (%): 17.36 | MFU (%): 42.71 | TFLOPs: 422.39
2025-05-19 20:21:54,576 - root - INFO - Step: 85 | Loss: 9.58 | Tokens/sec: 8184.53 | Training tokens/sec (%): 16.04 | MFU (%): 42.65 | TFLOPs: 421.84
2025-05-19 20:21:57,261 - root - INFO - Step: 90 | Loss: 9.00 | Tokens/sec: 7753.67 | Training tokens/sec (%): 57.98 | MFU (%): 40.41 | TFLOPs: 399.63
2025-05-19 20:21:59,930 - root - INFO - Step: 95 | Loss: 8.75 | Tokens/sec: 7799.12 | Training tokens/sec (%): 57.90 | MFU (%): 40.64 | TFLOPs: 401.98
2025-05-19 20:22:02,708 - root - INFO - Step: 100 | Loss: 8.90 | Tokens/sec: 7491.01 | Training tokens/sec (%): 93.89 | MFU (%): 39.04 | TFLOPs: 386.10
2025-05-19 20:22:05,257 - root - INFO - Step: 105 | Loss: 9.14 | Tokens/sec: 8172.51 | Training tokens/sec (%): 17.91 | MFU (%): 42.59 | TFLOPs: 421.22
2025-05-19 20:22:07,825 - root - INFO - Step: 110 | Loss: 9.26 | Tokens/sec: 8113.19 | Training tokens/sec (%): 25.76 | MFU (%): 42.28 | TFLOPs: 418.16
2025-05-19 20:22:10,345 - root - INFO - Step: 115 | Loss: 9.09 | Tokens/sec: 8268.88 | Training tokens/sec (%): 9.98 | MFU (%): 43.09 | TFLOPs: 426.19
2025-05-19 20:22:12,921 - root - INFO - Step: 120 | Loss: 8.96 | Tokens/sec: 8086.87 | Training tokens/sec (%): 26.43 | MFU (%): 42.14 | TFLOPs: 416.81
2025-05-19 20:22:15,487 - root - INFO - Step: 125 | Loss: 9.22 | Tokens/sec: 8119.40 | Training tokens/sec (%): 24.73 | MFU (%): 42.31 | TFLOPs: 418.48
2025-05-19 20:22:18,035 - root - INFO - Step: 130 | Loss: 9.53 | Tokens/sec: 8177.31 | Training tokens/sec (%): 17.81 | MFU (%): 42.62 | TFLOPs: 421.47
2025-05-19 20:22:20,599 - root - INFO - Step: 135 | Loss: 8.86 | Tokens/sec: 8125.79 | Training tokens/sec (%): 21.95 | MFU (%): 42.35 | TFLOPs: 418.81
2025-05-19 20:22:23,126 - root - INFO - Step: 140 | Loss: 8.75 | Tokens/sec: 8246.85 | Training tokens/sec (%): 11.89 | MFU (%): 42.98 | TFLOPs: 425.05
2025-05-19 20:22:25,704 - root - INFO - Step: 145 | Loss: 8.74 | Tokens/sec: 8082.39 | Training tokens/sec (%): 26.10 | MFU (%): 42.12 | TFLOPs: 416.58
2025-05-19 20:22:28,252 - root - INFO - Step: 150 | Loss: 9.00 | Tokens/sec: 8175.55 | Training tokens/sec (%): 19.74 | MFU (%): 42.61 | TFLOPs: 421.38
2025-05-19 20:22:30,862 - root - INFO - Step: 155 | Loss: 8.92 | Tokens/sec: 7979.61 | Training tokens/sec (%): 37.10 | MFU (%): 41.59 | TFLOPs: 411.28
2025-05-19 20:22:33,424 - root - INFO - Step: 160 | Loss: 8.21 | Tokens/sec: 8131.19 | Training tokens/sec (%): 22.84 | MFU (%): 42.38 | TFLOPs: 419.09
2025-05-19 20:22:35,991 - root - INFO - Step: 165 | Loss: 8.62 | Tokens/sec: 8116.01 | Training tokens/sec (%): 26.44 | MFU (%): 42.30 | TFLOPs: 418.31
2025-05-19 20:22:38,608 - root - INFO - Step: 170 | Loss: 9.00 | Tokens/sec: 7960.21 | Training tokens/sec (%): 39.34 | MFU (%): 41.48 | TFLOPs: 410.28
2025-05-19 20:22:41,160 - root - INFO - Step: 175 | Loss: 8.78 | Tokens/sec: 8164.63 | Training tokens/sec (%): 19.59 | MFU (%): 42.55 | TFLOPs: 420.82
2025-05-19 20:22:43,702 - root - INFO - Step: 180 | Loss: 8.48 | Tokens/sec: 8195.20 | Training tokens/sec (%): 14.69 | MFU (%): 42.71 | TFLOPs: 422.39
2025-05-19 20:22:46,230 - root - INFO - Step: 185 | Loss: 8.82 | Tokens/sec: 8242.74 | Training tokens/sec (%): 13.71 | MFU (%): 42.96 | TFLOPs: 424.84
2025-05-19 20:22:48,791 - root - INFO - Step: 190 | Loss: 8.49 | Tokens/sec: 8137.44 | Training tokens/sec (%): 21.21 | MFU (%): 42.41 | TFLOPs: 419.41
2025-05-19 20:22:51,403 - root - INFO - Step: 195 | Loss: 8.54 | Tokens/sec: 7973.18 | Training tokens/sec (%): 42.67 | MFU (%): 41.55 | TFLOPs: 410.95
2025-05-19 20:22:53,948 - root - INFO - Step: 200 | Loss: 8.76 | Tokens/sec: 8185.87 | Training tokens/sec (%): 16.92 | MFU (%): 42.66 | TFLOPs: 421.91
2025-05-19 20:22:56,471 - root - INFO - Step: 205 | Loss: 7.76 | Tokens/sec: 8261.95 | Training tokens/sec (%): 9.70 | MFU (%): 43.06 | TFLOPs: 425.83
2025-05-19 20:22:59,024 - root - INFO - Step: 210 | Loss: 8.60 | Tokens/sec: 8160.00 | Training tokens/sec (%): 19.35 | MFU (%): 42.53 | TFLOPs: 420.58
2025-05-19 20:23:01,549 - root - INFO - Step: 215 | Loss: 8.36 | Tokens/sec: 8252.87 | Training tokens/sec (%): 12.01 | MFU (%): 43.01 | TFLOPs: 425.36
2025-05-19 20:23:04,084 - root - INFO - Step: 220 | Loss: 8.63 | Tokens/sec: 8220.82 | Training tokens/sec (%): 12.01 | MFU (%): 42.84 | TFLOPs: 423.71
2025-05-19 20:23:06,659 - root - INFO - Step: 225 | Loss: 8.08 | Tokens/sec: 8089.58 | Training tokens/sec (%): 25.42 | MFU (%): 42.16 | TFLOPs: 416.95
2025-05-19 20:23:09,170 - root - INFO - Step: 230 | Loss: 8.08 | Tokens/sec: 8302.09 | Training tokens/sec (%): 6.27 | MFU (%): 43.27 | TFLOPs: 427.90
2025-05-19 20:23:11,705 - root - INFO - Step: 235 | Loss: 8.38 | Tokens/sec: 8219.57 | Training tokens/sec (%): 13.84 | MFU (%): 42.84 | TFLOPs: 423.65
2025-05-19 20:23:14,283 - root - INFO - Step: 240 | Loss: 8.10 | Tokens/sec: 8079.73 | Training tokens/sec (%): 28.71 | MFU (%): 42.11 | TFLOPs: 416.44
2025-05-19 20:23:16,869 - root - INFO - Step: 245 | Loss: 8.17 | Tokens/sec: 8054.11 | Training tokens/sec (%): 31.89 | MFU (%): 41.97 | TFLOPs: 415.12
2025-05-19 20:23:19,469 - root - INFO - Step: 250 | Loss: 8.22 | Tokens/sec: 8011.80 | Training tokens/sec (%): 35.94 | MFU (%): 41.75 | TFLOPs: 412.94
2025-05-19 20:23:21,990 - root - INFO - Step: 255 | Loss: 9.04 | Tokens/sec: 8268.45 | Training tokens/sec (%): 11.16 | MFU (%): 43.09 | TFLOPs: 426.17
2025-05-19 20:23:24,571 - root - INFO - Step: 260 | Loss: 9.32 | Tokens/sec: 8069.84 | Training tokens/sec (%): 30.02 | MFU (%): 42.06 | TFLOPs: 415.93
2025-05-19 20:23:27,105 - root - INFO - Step: 265 | Loss: 8.28 | Tokens/sec: 8222.01 | Training tokens/sec (%): 12.67 | MFU (%): 42.85 | TFLOPs: 423.77
2025-05-19 20:23:29,648 - root - INFO - Step: 270 | Loss: 8.21 | Tokens/sec: 8193.71 | Training tokens/sec (%): 17.27 | MFU (%): 42.70 | TFLOPs: 422.31
2025-05-19 20:23:32,185 - root - INFO - Step: 275 | Loss: 8.39 | Tokens/sec: 8215.53 | Training tokens/sec (%): 13.21 | MFU (%): 42.81 | TFLOPs: 423.44
2025-05-19 20:23:34,773 - root - INFO - Step: 280 | Loss: 8.03 | Tokens/sec: 8046.82 | Training tokens/sec (%): 27.62 | MFU (%): 41.94 | TFLOPs: 414.74
2025-05-19 20:23:37,339 - root - INFO - Step: 285 | Loss: 8.57 | Tokens/sec: 8121.42 | Training tokens/sec (%): 21.59 | MFU (%): 42.32 | TFLOPs: 418.59
2025-05-19 20:23:39,872 - root - INFO - Step: 290 | Loss: 8.04 | Tokens/sec: 8224.30 | Training tokens/sec (%): 13.66 | MFU (%): 42.86 | TFLOPs: 423.89
2025-05-19 20:23:42,405 - root - INFO - Step: 295 | Loss: 7.82 | Tokens/sec: 8227.83 | Training tokens/sec (%): 11.15 | MFU (%): 42.88 | TFLOPs: 424.07
2025-05-19 20:23:45,069 - root - INFO - Step: 300 | Loss: 7.91 | Tokens/sec: 7816.84 | Training tokens/sec (%): 54.36 | MFU (%): 40.74 | TFLOPs: 402.89
2025-05-19 20:23:47,629 - root - INFO - Step: 305 | Loss: 8.89 | Tokens/sec: 8139.15 | Training tokens/sec (%): 21.34 | MFU (%): 42.42 | TFLOPs: 419.50
2025-05-19 20:23:50,175 - root - INFO - Step: 310 | Loss: 8.43 | Tokens/sec: 8183.16 | Training tokens/sec (%): 15.84 | MFU (%): 42.65 | TFLOPs: 421.77
2025-05-19 20:23:52,753 - root - INFO - Step: 315 | Loss: 7.79 | Tokens/sec: 8078.97 | Training tokens/sec (%): 28.90 | MFU (%): 42.10 | TFLOPs: 416.40
2025-05-19 20:23:55,347 - root - INFO - Step: 320 | Loss: 8.41 | Tokens/sec: 8030.98 | Training tokens/sec (%): 31.73 | MFU (%): 41.85 | TFLOPs: 413.93
2025-05-19 20:23:57,916 - root - INFO - Step: 325 | Loss: 8.09 | Tokens/sec: 8110.35 | Training tokens/sec (%): 27.17 | MFU (%): 42.27 | TFLOPs: 418.02
2025-05-19 20:24:00,499 - root - INFO - Step: 330 | Loss: 7.29 | Tokens/sec: 8064.06 | Training tokens/sec (%): 30.51 | MFU (%): 42.03 | TFLOPs: 415.63
2025-05-19 20:24:03,002 - root - INFO - Step: 335 | Loss: 8.50 | Tokens/sec: 8326.83 | Training tokens/sec (%): 6.10 | MFU (%): 43.39 | TFLOPs: 429.17
2025-05-19 20:24:05,539 - root - INFO - Step: 340 | Loss: 8.35 | Tokens/sec: 8215.20 | Training tokens/sec (%): 16.78 | MFU (%): 42.81 | TFLOPs: 423.42
2025-05-19 20:24:08,095 - root - INFO - Step: 345 | Loss: 8.21 | Tokens/sec: 8149.09 | Training tokens/sec (%): 19.16 | MFU (%): 42.47 | TFLOPs: 420.01
2025-05-19 20:24:10,650 - root - INFO - Step: 350 | Loss: 8.32 | Tokens/sec: 8155.63 | Training tokens/sec (%): 19.25 | MFU (%): 42.50 | TFLOPs: 420.35
2025-05-19 20:24:13,168 - root - INFO - Step: 355 | Loss: 8.23 | Tokens/sec: 8275.74 | Training tokens/sec (%): 9.23 | MFU (%): 43.13 | TFLOPs: 426.54
2025-05-19 20:24:15,743 - root - INFO - Step: 360 | Loss: 7.81 | Tokens/sec: 8090.32 | Training tokens/sec (%): 25.02 | MFU (%): 42.16 | TFLOPs: 416.98
2025-05-19 20:24:18,306 - root - INFO - Step: 365 | Loss: 8.04 | Tokens/sec: 8127.96 | Training tokens/sec (%): 20.51 | MFU (%): 42.36 | TFLOPs: 418.93
2025-05-19 20:24:20,848 - root - INFO - Step: 370 | Loss: 7.54 | Tokens/sec: 8197.15 | Training tokens/sec (%): 17.57 | MFU (%): 42.72 | TFLOPs: 422.49
2025-05-19 20:24:23,522 - root - INFO - Step: 375 | Loss: 8.31 | Tokens/sec: 7787.46 | Training tokens/sec (%): 56.57 | MFU (%): 40.58 | TFLOPs: 401.37
2025-05-19 20:24:26,134 - root - INFO - Step: 380 | Loss: 7.41 | Tokens/sec: 7973.06 | Training tokens/sec (%): 34.63 | MFU (%): 41.55 | TFLOPs: 410.94
2025-05-19 20:24:28,681 - root - INFO - Step: 385 | Loss: 7.89 | Tokens/sec: 8179.63 | Training tokens/sec (%): 17.60 | MFU (%): 42.63 | TFLOPs: 421.59
2025-05-19 20:24:31,247 - root - INFO - Step: 390 | Loss: 7.70 | Tokens/sec: 8119.86 | Training tokens/sec (%): 23.14 | MFU (%): 42.32 | TFLOPs: 418.51
2025-05-19 20:24:33,818 - root - INFO - Step: 395 | Loss: 8.10 | Tokens/sec: 8103.59 | Training tokens/sec (%): 22.83 | MFU (%): 42.23 | TFLOPs: 417.67
2025-05-19 20:24:36,389 - root - INFO - Step: 400 | Loss: 7.55 | Tokens/sec: 8102.65 | Training tokens/sec (%): 28.39 | MFU (%): 42.23 | TFLOPs: 417.62
2025-05-19 20:24:38,919 - root - INFO - Step: 405 | Loss: 7.92 | Tokens/sec: 8238.49 | Training tokens/sec (%): 13.37 | MFU (%): 42.93 | TFLOPs: 424.62
2025-05-19 20:24:41,466 - root - INFO - Step: 410 | Loss: 8.20 | Tokens/sec: 8177.79 | Training tokens/sec (%): 17.92 | MFU (%): 42.62 | TFLOPs: 421.49
2025-05-19 20:24:44,067 - root - INFO - Step: 415 | Loss: 8.04 | Tokens/sec: 8009.99 | Training tokens/sec (%): 31.84 | MFU (%): 41.74 | TFLOPs: 412.84
2025-05-19 20:24:46,605 - root - INFO - Step: 420 | Loss: 8.08 | Tokens/sec: 8209.10 | Training tokens/sec (%): 13.01 | MFU (%): 42.78 | TFLOPs: 423.11
2025-05-19 20:24:49,122 - root - INFO - Step: 425 | Loss: 8.00 | Tokens/sec: 8279.78 | Training tokens/sec (%): 10.23 | MFU (%): 43.15 | TFLOPs: 426.75
2025-05-19 20:24:51,696 - root - INFO - Step: 430 | Loss: 8.50 | Tokens/sec: 8092.83 | Training tokens/sec (%): 23.21 | MFU (%): 42.18 | TFLOPs: 417.11
2025-05-19 20:24:54,339 - root - INFO - Step: 435 | Loss: 8.09 | Tokens/sec: 7878.37 | Training tokens/sec (%): 48.59 | MFU (%): 41.06 | TFLOPs: 406.06
2025-05-19 20:24:56,883 - root - INFO - Step: 440 | Loss: 7.76 | Tokens/sec: 8193.36 | Training tokens/sec (%): 14.97 | MFU (%): 42.70 | TFLOPs: 422.30
2025-05-19 20:24:59,457 - root - INFO - Step: 445 | Loss: 7.46 | Tokens/sec: 8092.12 | Training tokens/sec (%): 24.81 | MFU (%): 42.17 | TFLOPs: 417.08
2025-05-19 20:25:02,037 - root - INFO - Step: 450 | Loss: 7.93 | Tokens/sec: 8073.73 | Training tokens/sec (%): 26.11 | MFU (%): 42.08 | TFLOPs: 416.13
2025-05-19 20:25:04,674 - root - INFO - Step: 455 | Loss: 7.43 | Tokens/sec: 7896.84 | Training tokens/sec (%): 44.85 | MFU (%): 41.15 | TFLOPs: 407.01
2025-05-19 20:25:07,234 - root - INFO - Step: 460 | Loss: 7.65 | Tokens/sec: 8138.72 | Training tokens/sec (%): 20.43 | MFU (%): 42.41 | TFLOPs: 419.48
2025-05-19 20:25:09,813 - root - INFO - Step: 465 | Loss: 7.70 | Tokens/sec: 8077.07 | Training tokens/sec (%): 24.75 | MFU (%): 42.09 | TFLOPs: 416.30
2025-05-19 20:25:12,388 - root - INFO - Step: 470 | Loss: 7.75 | Tokens/sec: 8092.39 | Training tokens/sec (%): 24.22 | MFU (%): 42.17 | TFLOPs: 417.09
2025-05-19 20:25:14,968 - root - INFO - Step: 475 | Loss: 7.92 | Tokens/sec: 8074.15 | Training tokens/sec (%): 27.67 | MFU (%): 42.08 | TFLOPs: 416.15
2025-05-19 20:25:17,551 - root - INFO - Step: 480 | Loss: 7.47 | Tokens/sec: 8064.33 | Training tokens/sec (%): 28.85 | MFU (%): 42.03 | TFLOPs: 415.65
2025-05-19 20:25:20,083 - root - INFO - Step: 485 | Loss: 7.90 | Tokens/sec: 8228.72 | Training tokens/sec (%): 12.13 | MFU (%): 42.88 | TFLOPs: 424.12
2025-05-19 20:25:22,622 - root - INFO - Step: 490 | Loss: 8.18 | Tokens/sec: 8205.88 | Training tokens/sec (%): 15.93 | MFU (%): 42.76 | TFLOPs: 422.94
2025-05-19 20:25:25,194 - root - INFO - Step: 495 | Loss: 8.25 | Tokens/sec: 8101.02 | Training tokens/sec (%): 26.74 | MFU (%): 42.22 | TFLOPs: 417.54
2025-05-19 20:25:27,780 - root - INFO - Step: 500 | Loss: 8.51 | Tokens/sec: 8056.08 | Training tokens/sec (%): 29.65 | MFU (%): 41.98 | TFLOPs: 415.22
2025-05-19 20:25:30,318 - root - INFO - Step: 505 | Loss: 7.75 | Tokens/sec: 8208.52 | Training tokens/sec (%): 16.09 | MFU (%): 42.78 | TFLOPs: 423.08
2025-05-19 20:25:32,867 - root - INFO - Step: 510 | Loss: 8.44 | Tokens/sec: 8174.03 | Training tokens/sec (%): 16.85 | MFU (%): 42.60 | TFLOPs: 421.30
2025-05-19 20:25:35,420 - root - INFO - Step: 515 | Loss: 6.99 | Tokens/sec: 8160.99 | Training tokens/sec (%): 19.05 | MFU (%): 42.53 | TFLOPs: 420.63
2025-05-19 20:25:37,972 - root - INFO - Step: 520 | Loss: 7.44 | Tokens/sec: 8167.11 | Training tokens/sec (%): 18.01 | MFU (%): 42.56 | TFLOPs: 420.94
2025-05-19 20:25:40,558 - root - INFO - Step: 525 | Loss: 7.80 | Tokens/sec: 8052.18 | Training tokens/sec (%): 28.13 | MFU (%): 41.96 | TFLOPs: 415.02
2025-05-19 20:25:43,135 - root - INFO - Step: 530 | Loss: 7.78 | Tokens/sec: 8086.08 | Training tokens/sec (%): 26.11 | MFU (%): 42.14 | TFLOPs: 416.77
2025-05-19 20:25:45,793 - root - INFO - Step: 535 | Loss: 8.11 | Tokens/sec: 7832.15 | Training tokens/sec (%): 51.25 | MFU (%): 40.82 | TFLOPs: 403.68
2025-05-19 20:25:48,363 - root - INFO - Step: 540 | Loss: 6.22 | Tokens/sec: 8106.28 | Training tokens/sec (%): 28.41 | MFU (%): 42.25 | TFLOPs: 417.81
2025-05-19 20:25:50,982 - root - INFO - Step: 545 | Loss: 7.69 | Tokens/sec: 7951.82 | Training tokens/sec (%): 38.98 | MFU (%): 41.44 | TFLOPs: 409.85
2025-05-19 20:25:53,507 - root - INFO - Step: 550 | Loss: 7.95 | Tokens/sec: 8254.78 | Training tokens/sec (%): 10.88 | MFU (%): 43.02 | TFLOPs: 425.46
2025-05-19 20:25:56,039 - root - INFO - Step: 555 | Loss: 9.41 | Tokens/sec: 8229.22 | Training tokens/sec (%): 13.59 | MFU (%): 42.89 | TFLOPs: 424.14
2025-05-19 20:25:58,603 - root - INFO - Step: 560 | Loss: 8.28 | Tokens/sec: 8126.00 | Training tokens/sec (%): 21.19 | MFU (%): 42.35 | TFLOPs: 418.82
2025-05-19 20:26:01,120 - root - INFO - Step: 565 | Loss: 7.77 | Tokens/sec: 8280.15 | Training tokens/sec (%): 10.85 | MFU (%): 43.15 | TFLOPs: 426.77
2025-05-19 20:26:03,638 - root - INFO - Step: 570 | Loss: 8.35 | Tokens/sec: 8275.16 | Training tokens/sec (%): 9.92 | MFU (%): 43.13 | TFLOPs: 426.51
2025-05-19 20:26:06,168 - root - INFO - Step: 575 | Loss: 7.48 | Tokens/sec: 8238.20 | Training tokens/sec (%): 11.96 | MFU (%): 42.93 | TFLOPs: 424.61
2025-05-19 20:26:08,682 - root - INFO - Step: 580 | Loss: 8.07 | Tokens/sec: 8289.14 | Training tokens/sec (%): 7.41 | MFU (%): 43.20 | TFLOPs: 427.23
2025-05-19 20:26:11,223 - root - INFO - Step: 585 | Loss: 7.45 | Tokens/sec: 8199.51 | Training tokens/sec (%): 16.47 | MFU (%): 42.73 | TFLOPs: 422.61
2025-05-19 20:26:13,764 - root - INFO - Step: 590 | Loss: 7.86 | Tokens/sec: 8201.63 | Training tokens/sec (%): 16.10 | MFU (%): 42.74 | TFLOPs: 422.72
2025-05-19 20:26:16,294 - root - INFO - Step: 595 | Loss: 8.20 | Tokens/sec: 8235.67 | Training tokens/sec (%): 11.91 | MFU (%): 42.92 | TFLOPs: 424.48
2025-05-19 20:26:18,814 - root - INFO - Step: 600 | Loss: 7.77 | Tokens/sec: 8269.08 | Training tokens/sec (%): 11.46 | MFU (%): 43.09 | TFLOPs: 426.20
2025-05-19 20:26:21,385 - root - INFO - Step: 605 | Loss: 8.03 | Tokens/sec: 8103.73 | Training tokens/sec (%): 26.98 | MFU (%): 42.23 | TFLOPs: 417.68
2025-05-19 20:26:23,932 - root - INFO - Step: 610 | Loss: 8.96 | Tokens/sec: 8180.96 | Training tokens/sec (%): 15.95 | MFU (%): 42.63 | TFLOPs: 421.66
2025-05-19 20:26:26,500 - root - INFO - Step: 615 | Loss: 7.72 | Tokens/sec: 8112.27 | Training tokens/sec (%): 23.21 | MFU (%): 42.28 | TFLOPs: 418.12
2025-05-19 20:26:29,028 - root - INFO - Step: 620 | Loss: 7.35 | Tokens/sec: 8242.85 | Training tokens/sec (%): 14.51 | MFU (%): 42.96 | TFLOPs: 424.85
2025-05-19 20:26:31,591 - root - INFO - Step: 625 | Loss: 7.52 | Tokens/sec: 8131.37 | Training tokens/sec (%): 22.61 | MFU (%): 42.38 | TFLOPs: 419.10
2025-05-19 20:26:34,121 - root - INFO - Step: 630 | Loss: 7.75 | Tokens/sec: 8235.93 | Training tokens/sec (%): 13.96 | MFU (%): 42.92 | TFLOPs: 424.49
2025-05-19 20:26:36,732 - root - INFO - Step: 635 | Loss: 8.10 | Tokens/sec: 7974.61 | Training tokens/sec (%): 36.07 | MFU (%): 41.56 | TFLOPs: 411.02
2025-05-19 20:26:39,276 - root - INFO - Step: 640 | Loss: 7.85 | Tokens/sec: 8192.79 | Training tokens/sec (%): 15.43 | MFU (%): 42.70 | TFLOPs: 422.27
2025-05-19 20:26:41,812 - root - INFO - Step: 645 | Loss: 7.66 | Tokens/sec: 8217.05 | Training tokens/sec (%): 15.98 | MFU (%): 42.82 | TFLOPs: 423.52
2025-05-19 20:26:44,440 - root - INFO - Step: 650 | Loss: 7.45 | Tokens/sec: 7922.01 | Training tokens/sec (%): 44.35 | MFU (%): 41.29 | TFLOPs: 408.31
2025-05-19 20:26:47,009 - root - INFO - Step: 655 | Loss: 7.80 | Tokens/sec: 8112.36 | Training tokens/sec (%): 27.18 | MFU (%): 42.28 | TFLOPs: 418.12
2025-05-19 20:26:49,539 - root - INFO - Step: 660 | Loss: 7.80 | Tokens/sec: 8236.11 | Training tokens/sec (%): 13.00 | MFU (%): 42.92 | TFLOPs: 424.50
2025-05-19 20:26:52,140 - root - INFO - Step: 665 | Loss: 7.64 | Tokens/sec: 8008.06 | Training tokens/sec (%): 35.04 | MFU (%): 41.73 | TFLOPs: 412.75
2025-05-19 20:26:54,694 - root - INFO - Step: 670 | Loss: 7.08 | Tokens/sec: 8156.23 | Training tokens/sec (%): 18.38 | MFU (%): 42.51 | TFLOPs: 420.38
2025-05-19 20:26:57,208 - root - INFO - Step: 675 | Loss: 7.05 | Tokens/sec: 8291.56 | Training tokens/sec (%): 9.26 | MFU (%): 43.21 | TFLOPs: 427.36
2025-05-19 20:26:59,787 - root - INFO - Step: 680 | Loss: 7.59 | Tokens/sec: 8077.94 | Training tokens/sec (%): 30.43 | MFU (%): 42.10 | TFLOPs: 416.35
2025-05-19 20:27:02,346 - root - INFO - Step: 685 | Loss: 8.40 | Tokens/sec: 8141.17 | Training tokens/sec (%): 19.60 | MFU (%): 42.43 | TFLOPs: 419.61
2025-05-19 20:27:04,857 - root - INFO - Step: 690 | Loss: 7.44 | Tokens/sec: 8299.35 | Training tokens/sec (%): 7.32 | MFU (%): 43.25 | TFLOPs: 427.76
2025-05-19 20:27:07,499 - root - INFO - Step: 695 | Loss: 7.82 | Tokens/sec: 7880.10 | Training tokens/sec (%): 49.85 | MFU (%): 41.07 | TFLOPs: 406.15
2025-05-19 20:27:10,058 - root - INFO - Step: 700 | Loss: 7.36 | Tokens/sec: 8143.91 | Training tokens/sec (%): 19.23 | MFU (%): 42.44 | TFLOPs: 419.75
2025-05-19 20:27:12,621 - root - INFO - Step: 705 | Loss: 7.62 | Tokens/sec: 8128.54 | Training tokens/sec (%): 20.72 | MFU (%): 42.36 | TFLOPs: 418.95
2025-05-19 20:27:15,228 - root - INFO - Step: 710 | Loss: 7.65 | Tokens/sec: 7988.60 | Training tokens/sec (%): 32.88 | MFU (%): 41.63 | TFLOPs: 411.74
2025-05-19 20:27:17,806 - root - INFO - Step: 715 | Loss: 7.46 | Tokens/sec: 8080.81 | Training tokens/sec (%): 29.16 | MFU (%): 42.11 | TFLOPs: 416.49
2025-05-19 20:27:20,333 - root - INFO - Step: 720 | Loss: 6.51 | Tokens/sec: 8246.03 | Training tokens/sec (%): 11.67 | MFU (%): 42.97 | TFLOPs: 425.01
2025-05-19 20:27:22,855 - root - INFO - Step: 725 | Loss: 7.61 | Tokens/sec: 8263.83 | Training tokens/sec (%): 9.85 | MFU (%): 43.07 | TFLOPs: 425.93
2025-05-19 20:27:25,380 - root - INFO - Step: 730 | Loss: 8.03 | Tokens/sec: 8252.00 | Training tokens/sec (%): 11.26 | MFU (%): 43.00 | TFLOPs: 425.32
2025-05-19 20:27:27,899 - root - INFO - Step: 735 | Loss: 7.59 | Tokens/sec: 8274.63 | Training tokens/sec (%): 9.29 | MFU (%): 43.12 | TFLOPs: 426.48
2025-05-19 20:27:30,475 - root - INFO - Step: 740 | Loss: 7.86 | Tokens/sec: 8088.18 | Training tokens/sec (%): 29.05 | MFU (%): 42.15 | TFLOPs: 416.87
2025-05-19 20:27:32,991 - root - INFO - Step: 745 | Loss: 7.81 | Tokens/sec: 8282.18 | Training tokens/sec (%): 9.51 | MFU (%): 43.16 | TFLOPs: 426.87
2025-05-19 20:27:35,538 - root - INFO - Step: 750 | Loss: 7.59 | Tokens/sec: 8181.34 | Training tokens/sec (%): 19.01 | MFU (%): 42.64 | TFLOPs: 421.68
2025-05-19 20:27:38,089 - root - INFO - Step: 755 | Loss: 7.45 | Tokens/sec: 8166.24 | Training tokens/sec (%): 19.92 | MFU (%): 42.56 | TFLOPs: 420.90
2025-05-19 20:27:40,691 - root - INFO - Step: 760 | Loss: 7.88 | Tokens/sec: 8004.33 | Training tokens/sec (%): 35.18 | MFU (%): 41.71 | TFLOPs: 412.55
2025-05-19 20:27:43,350 - root - INFO - Step: 765 | Loss: 7.48 | Tokens/sec: 7830.42 | Training tokens/sec (%): 55.83 | MFU (%): 40.81 | TFLOPs: 403.59
2025-05-19 20:27:45,898 - root - INFO - Step: 770 | Loss: 7.25 | Tokens/sec: 8177.98 | Training tokens/sec (%): 18.56 | MFU (%): 42.62 | TFLOPs: 421.50
2025-05-19 20:27:48,476 - root - INFO - Step: 775 | Loss: 7.27 | Tokens/sec: 8080.20 | Training tokens/sec (%): 29.94 | MFU (%): 42.11 | TFLOPs: 416.46
2025-05-19 20:27:51,004 - root - INFO - Step: 780 | Loss: 8.31 | Tokens/sec: 8245.11 | Training tokens/sec (%): 12.24 | MFU (%): 42.97 | TFLOPs: 424.96
2025-05-19 20:27:53,549 - root - INFO - Step: 785 | Loss: 7.67 | Tokens/sec: 8186.08 | Training tokens/sec (%): 17.48 | MFU (%): 42.66 | TFLOPs: 421.92
2025-05-19 20:27:56,101 - root - INFO - Step: 790 | Loss: 7.68 | Tokens/sec: 8164.68 | Training tokens/sec (%): 18.63 | MFU (%): 42.55 | TFLOPs: 420.82
2025-05-19 20:27:58,728 - root - INFO - Step: 795 | Loss: 7.03 | Tokens/sec: 7927.46 | Training tokens/sec (%): 44.50 | MFU (%): 41.31 | TFLOPs: 408.59
2025-05-19 20:28:01,305 - root - INFO - Step: 800 | Loss: 7.49 | Tokens/sec: 8083.73 | Training tokens/sec (%): 25.66 | MFU (%): 42.13 | TFLOPs: 416.65
2025-05-19 20:28:03,917 - root - INFO - Step: 805 | Loss: 7.46 | Tokens/sec: 7974.77 | Training tokens/sec (%): 38.37 | MFU (%): 41.56 | TFLOPs: 411.03
2025-05-19 20:28:06,462 - root - INFO - Step: 810 | Loss: 7.37 | Tokens/sec: 8185.08 | Training tokens/sec (%): 17.12 | MFU (%): 42.66 | TFLOPs: 421.87
2025-05-19 20:28:09,051 - root - INFO - Step: 815 | Loss: 8.19 | Tokens/sec: 8048.14 | Training tokens/sec (%): 30.96 | MFU (%): 41.94 | TFLOPs: 414.81
2025-05-19 20:28:11,603 - root - INFO - Step: 820 | Loss: 7.31 | Tokens/sec: 8164.54 | Training tokens/sec (%): 18.55 | MFU (%): 42.55 | TFLOPs: 420.81
2025-05-19 20:28:14,208 - root - INFO - Step: 825 | Loss: 7.55 | Tokens/sec: 7994.19 | Training tokens/sec (%): 32.02 | MFU (%): 41.66 | TFLOPs: 412.03
2025-05-19 20:28:16,767 - root - INFO - Step: 830 | Loss: 7.63 | Tokens/sec: 8142.09 | Training tokens/sec (%): 19.21 | MFU (%): 42.43 | TFLOPs: 419.65
2025-05-19 20:28:19,283 - root - INFO - Step: 835 | Loss: 7.77 | Tokens/sec: 8282.47 | Training tokens/sec (%): 9.45 | MFU (%): 43.16 | TFLOPs: 426.89
2025-05-19 20:28:21,798 - root - INFO - Step: 840 | Loss: 7.80 | Tokens/sec: 8287.89 | Training tokens/sec (%): 8.98 | MFU (%): 43.19 | TFLOPs: 427.17
2025-05-19 20:28:24,325 - root - INFO - Step: 845 | Loss: 7.99 | Tokens/sec: 8247.22 | Training tokens/sec (%): 14.42 | MFU (%): 42.98 | TFLOPs: 425.07
2025-05-19 20:28:26,861 - root - INFO - Step: 850 | Loss: 7.36 | Tokens/sec: 8214.27 | Training tokens/sec (%): 14.26 | MFU (%): 42.81 | TFLOPs: 423.37
2025-05-19 20:28:29,453 - root - INFO - Step: 855 | Loss: 7.86 | Tokens/sec: 8037.71 | Training tokens/sec (%): 30.06 | MFU (%): 41.89 | TFLOPs: 414.27
2025-05-19 20:28:31,972 - root - INFO - Step: 860 | Loss: 7.69 | Tokens/sec: 8273.14 | Training tokens/sec (%): 8.63 | MFU (%): 43.12 | TFLOPs: 426.41
2025-05-19 20:28:34,510 - root - INFO - Step: 865 | Loss: 6.96 | Tokens/sec: 8208.95 | Training tokens/sec (%): 15.03 | MFU (%): 42.78 | TFLOPs: 423.10
2025-05-19 20:28:37,077 - root - INFO - Step: 870 | Loss: 7.44 | Tokens/sec: 8118.59 | Training tokens/sec (%): 22.24 | MFU (%): 42.31 | TFLOPs: 418.44
2025-05-19 20:28:39,607 - root - INFO - Step: 875 | Loss: 7.53 | Tokens/sec: 8233.84 | Training tokens/sec (%): 13.85 | MFU (%): 42.91 | TFLOPs: 424.38
2025-05-19 20:28:42,150 - root - INFO - Step: 880 | Loss: 8.02 | Tokens/sec: 8193.88 | Training tokens/sec (%): 15.41 | MFU (%): 42.70 | TFLOPs: 422.32
2025-05-19 20:28:44,742 - root - INFO - Step: 885 | Loss: 7.03 | Tokens/sec: 8037.68 | Training tokens/sec (%): 31.47 | MFU (%): 41.89 | TFLOPs: 414.27
2025-05-19 20:28:47,312 - root - INFO - Step: 890 | Loss: 7.31 | Tokens/sec: 8107.24 | Training tokens/sec (%): 23.38 | MFU (%): 42.25 | TFLOPs: 417.86
2025-05-19 20:28:49,839 - root - INFO - Step: 895 | Loss: 7.98 | Tokens/sec: 8245.86 | Training tokens/sec (%): 12.66 | MFU (%): 42.97 | TFLOPs: 425.00
2025-05-19 20:28:52,377 - root - INFO - Step: 900 | Loss: 7.88 | Tokens/sec: 8209.42 | Training tokens/sec (%): 14.21 | MFU (%): 42.78 | TFLOPs: 423.12
2025-05-19 20:28:54,908 - root - INFO - Step: 905 | Loss: 7.89 | Tokens/sec: 8234.07 | Training tokens/sec (%): 11.89 | MFU (%): 42.91 | TFLOPs: 424.39
2025-05-19 20:28:57,485 - root - INFO - Step: 910 | Loss: 7.23 | Tokens/sec: 8081.59 | Training tokens/sec (%): 27.29 | MFU (%): 42.12 | TFLOPs: 416.53
2025-05-19 20:29:00,015 - root - INFO - Step: 915 | Loss: 7.65 | Tokens/sec: 8239.90 | Training tokens/sec (%): 12.34 | MFU (%): 42.94 | TFLOPs: 424.69
2025-05-19 20:29:02,574 - root - INFO - Step: 920 | Loss: 7.31 | Tokens/sec: 8140.36 | Training tokens/sec (%): 19.49 | MFU (%): 42.42 | TFLOPs: 419.56
2025-05-19 20:29:05,095 - root - INFO - Step: 925 | Loss: 7.18 | Tokens/sec: 8266.58 | Training tokens/sec (%): 10.24 | MFU (%): 43.08 | TFLOPs: 426.07
2025-05-19 20:29:07,666 - root - INFO - Step: 930 | Loss: 7.24 | Tokens/sec: 8102.26 | Training tokens/sec (%): 26.54 | MFU (%): 42.22 | TFLOPs: 417.60
2025-05-19 20:29:10,198 - root - INFO - Step: 935 | Loss: 7.86 | Tokens/sec: 8231.17 | Training tokens/sec (%): 13.64 | MFU (%): 42.90 | TFLOPs: 424.24
2025-05-19 20:29:12,753 - root - INFO - Step: 940 | Loss: 7.20 | Tokens/sec: 8152.35 | Training tokens/sec (%): 20.20 | MFU (%): 42.49 | TFLOPs: 420.18
2025-05-19 20:29:15,330 - root - INFO - Step: 945 | Loss: 7.73 | Tokens/sec: 8084.19 | Training tokens/sec (%): 28.11 | MFU (%): 42.13 | TFLOPs: 416.67
2025-05-19 20:29:17,972 - root - INFO - Step: 950 | Loss: 7.32 | Tokens/sec: 7882.49 | Training tokens/sec (%): 46.25 | MFU (%): 41.08 | TFLOPs: 406.27
2025-05-19 20:29:20,508 - root - INFO - Step: 955 | Loss: 7.30 | Tokens/sec: 8217.73 | Training tokens/sec (%): 14.33 | MFU (%): 42.83 | TFLOPs: 423.55
2025-05-19 20:29:23,107 - root - INFO - Step: 960 | Loss: 7.60 | Tokens/sec: 8013.72 | Training tokens/sec (%): 34.03 | MFU (%): 41.76 | TFLOPs: 413.04
2025-05-19 20:29:25,648 - root - INFO - Step: 965 | Loss: 7.67 | Tokens/sec: 8201.50 | Training tokens/sec (%): 14.93 | MFU (%): 42.74 | TFLOPs: 422.72
2025-05-19 20:29:28,168 - root - INFO - Step: 970 | Loss: 7.34 | Tokens/sec: 8267.72 | Training tokens/sec (%): 9.15 | MFU (%): 43.09 | TFLOPs: 426.13
2025-05-19 20:29:30,707 - root - INFO - Step: 975 | Loss: 7.01 | Tokens/sec: 8207.04 | Training tokens/sec (%): 15.41 | MFU (%): 42.77 | TFLOPs: 423.00
2025-05-19 20:29:33,333 - root - INFO - Step: 980 | Loss: 7.99 | Tokens/sec: 7932.78 | Training tokens/sec (%): 41.17 | MFU (%): 41.34 | TFLOPs: 408.86
2025-05-19 20:29:35,874 - root - INFO - Step: 985 | Loss: 7.31 | Tokens/sec: 8197.51 | Training tokens/sec (%): 16.06 | MFU (%): 42.72 | TFLOPs: 422.51
2025-05-19 20:29:38,400 - root - INFO - Step: 990 | Loss: 7.67 | Tokens/sec: 8252.64 | Training tokens/sec (%): 12.10 | MFU (%): 43.01 | TFLOPs: 425.35
2025-05-19 20:29:41,028 - root - INFO - Step: 995 | Loss: 7.83 | Tokens/sec: 7923.07 | Training tokens/sec (%): 46.52 | MFU (%): 41.29 | TFLOPs: 408.36
2025-05-19 20:29:43,580 - root - INFO - Step: 1000 | Loss: 7.00 | Tokens/sec: 8163.50 | Training tokens/sec (%): 18.49 | MFU (%): 42.54 | TFLOPs: 420.76
2025-05-19 20:29:43,581 - root - INFO - Training completed
2025-05-19 20:29:43,581 - root - INFO - === Average performance over training ===
2025-05-19 20:29:43,581 - root - INFO -   Avg Tokens/sec:      8127.71
2025-05-19 20:29:43,581 - root - INFO -   Avg Train Token %:   22.59
2025-05-19 20:29:43,581 - root - INFO -   Avg MFU %:           42.36
2025-05-19 20:29:43,581 - root - INFO -   Avg TFLOPs:          418.91
2025-05-19 20:29:43,581 - root - INFO - Total training time: 512.81 seconds
2025-05-19 20:29:43,583 - root - INFO - Measuring speed of current model...
2025-05-19 20:29:51,343 - root - INFO - [Speed] Avg inference time: 141.08 ms | Max GPU memory: 31.10 GB
